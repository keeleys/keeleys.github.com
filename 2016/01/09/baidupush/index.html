<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    
<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">



  <meta name="description" content="百度云推送分析"/>




  <meta name="keywords" content="baidupush" />










  <link rel="alternate" href="/default" title="http://www.sitec.cc/">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2.6.0" />



<link rel="canonical" href="http://www.sitec.cc/2016/01/09/baidupush/"/>


<link rel="stylesheet" type="text/css" href="/css/style.css?v=2.6.0" />






  



  <script id="baidu_push">
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>









    <title> 百度云推送分析 - http://www.sitec.cc/ </title>
  </head>

  <body><div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/." class="logo">http://www.sitec.cc/</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    
      <a href="/">
        <li class="mobile-menu-item">
          
          
            首页
          
        </li>
      </a>
    
      <a href="/archives/">
        <li class="mobile-menu-item">
          
          
            归档
          
        </li>
      </a>
    
  </ul>
</nav>

    <div class="container" id="mobile-panel">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">http://www.sitec.cc/</a>
</div>

<nav class="site-navbar">
  
    <ul id="menu" class="menu">
      
        <li class="menu-item">
          <a class="menu-item-link" href="/">
            
            
              首页
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/archives/">
            
            
              归档
            
          </a>
        </li>
      
    </ul>
  
</nav>

      </header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content">
            
  
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          百度云推送分析
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2016-01-09
        </span>
        
          <div class="post-category">
            
              <a href="/categories/APP推送/">APP推送</a>
            
          </div>
        
        
      </div>
    </header>

    
    
  <div class="post-toc" id="post-toc">
    <h2 class="post-toc-title">文章目录</h2>
    <div class="post-toc-content">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#百度云推送介绍"><span class="toc-text">百度云推送介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#云推送原理"><span class="toc-text">云推送原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#app端"><span class="toc-text">app端</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#服务器端"><span class="toc-text">服务器端</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#百度云推送的功能"><span class="toc-text">百度云推送的功能</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#服务端功能"><span class="toc-text">服务端功能</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#推送内容"><span class="toc-text">推送内容</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#推送方式"><span class="toc-text">推送方式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#统计"><span class="toc-text">统计</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#客户端"><span class="toc-text">客户端</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#APP端集成方式"><span class="toc-text">APP端集成方式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SDK下载"><span class="toc-text">SDK下载</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#在百度应用中心创建应用"><span class="toc-text">在百度应用中心创建应用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Android"><span class="toc-text">Android</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IOS"><span class="toc-text">IOS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#服务端api"><span class="toc-text">服务端api</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#api参考地址"><span class="toc-text">api参考地址</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#单个推送举例"><span class="toc-text">单个推送举例</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#网络通讯"><span class="toc-text">网络通讯</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#常见问题"><span class="toc-text">常见问题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#行业对比和评测"><span class="toc-text">行业对比和评测</span></a></li></ol>
    </div>
  </div>


    <div class="post-content">
      
        <h2 id="百度云推送介绍"><a href="#百度云推送介绍" class="headerlink" title="百度云推送介绍"></a>百度云推送介绍</h2><h3 id="云推送原理"><a href="#云推送原理" class="headerlink" title="云推送原理"></a>云推送原理</h3><p>云推送（Push）是百度开放云向开发者提供的消息推送服务,通过利用百度云端与客户端之间建立稳定、可靠的长连接来为开发者提供向客户端应用推送实时消息的一种开发者服务</p>
<p>android的流程<br>服务端 － 百度云 － app端</p>
<p>ios的流程<br>服务端 － 百度云 － 苹果APNS服务 － app端</p>
<a id="more"></a>
<h3 id="app端"><a href="#app端" class="headerlink" title="app端"></a>app端</h3><blockquote>
<p>app端负责接收百度云推送的消息接受</p>
</blockquote>
<p>只有成功集成了百度云推送客户端的SDK的应用才能接收到由”云推送”服务下发的消息<br>只支持 <code>Android</code>及<code>iOS</code>两个平台</p>
<h3 id="服务器端"><a href="#服务器端" class="headerlink" title="服务器端"></a>服务器端</h3><blockquote>
<p>服务器端负责提供推送数据，将数据发送到百度云推送平台。</p>
</blockquote>
<p>提供2种方式</p>
<ol>
<li>利用百度云提供的管理控制台来管理应用的推送，能实现所有推送功能和大部分统计功能</li>
<li>利用百度云提供的服务接口集成到自己的后台中</li>
<li>无论哪种方式，数据都是传递到百度云，经百度云再转发到设备</li>
</ol>
<h2 id="百度云推送的功能"><a href="#百度云推送的功能" class="headerlink" title="百度云推送的功能"></a>百度云推送的功能</h2><h3 id="服务端功能"><a href="#服务端功能" class="headerlink" title="服务端功能"></a>服务端功能</h3><h4 id="推送内容"><a href="#推送内容" class="headerlink" title="推送内容"></a>推送内容</h4><ul>
<li>推送系统通知栏通知，标题和内容</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">可设置点击通知的行为，1：打开Url; 2：自定义行为；3：默认打开应用;</span><br><span class="line"></span><br><span class="line">可以设置通知的基本样式包括(响铃：0x04;振动：0x02;可清除：0x01;),这是一个flag整形，每一位代表一种样式</span><br></pre></td></tr></table></figure>
<ul>
<li>推送透传消息，以静默的方式直接发送消息到客户端，然后客户端在进行后续动作</li>
<li><del>推送富媒体消息</del>（目前android测试的情况是，直接用富文本编辑器编辑的一个hmtl文本，然后将这个文本压缩成rar之后发送到app端，由于虚拟机没有sd卡，所以能收到通知但是无法看到富文本）</li>
</ul>
<h4 id="推送方式"><a href="#推送方式" class="headerlink" title="推送方式"></a>推送方式</h4><ul>
<li>添加标签（createTag）</li>
<li>删除标签（deleteTag）</li>
<li>向标签组中批量添加设备（addDevicesToTag）</li>
<li>从标签组中批量删除设备（deleteDevicesFromTag）</li>
<li>基于标签推送（pushMsgToTag）</li>
</ul>
<h4 id="统计"><a href="#统计" class="headerlink" title="统计"></a>统计</h4><ul>
<li>(查看标签组中关联的设备)queryDeviceNumInTag</li>
<li>(统计所有推送消息信息,返回30天内的)queryStatisticMsg</li>
<li>(统计某个消息的30天内的)queryStatisticTopic</li>
<li>(统计安装了app的设备数,返回30天的所有统计项)queryStatisticDevice</li>
</ul>
<p>经测试，调用统计接口发送的消息，通过服务端api调用方式消息之后立即查询统计都无效，需要隔一天之后才能查询。<br>通过百度控制台发送的，控制台也只有一个推送消息信息的发送列表，其他三个也没有。而且30天这个时间段还不能自己定义，百度提供的统计功能还是比较薄弱的，实际使用需要自己开发管理统计。</p>
<h3 id="客户端"><a href="#客户端" class="headerlink" title="客户端"></a>客户端</h3><ul>
<li>接受通知 Android/iOS</li>
<li>接收透传消息 Android/<del>IOS</del></li>
</ul>
<p>透传消息相当于直接的长链接请求，ios因为需要先通过ios的APNS服务然后再到设备，所以不支持透传。<del>不过百度推送官网提示即将支持ios</del></p>
<h2 id="APP端集成方式"><a href="#APP端集成方式" class="headerlink" title="APP端集成方式"></a>APP端集成方式</h2><h3 id="SDK下载"><a href="#SDK下载" class="headerlink" title="SDK下载"></a>SDK下载</h3><p>官网sdk下载 <a href="http://push.baidu.com/sdk/push_client_sdk_for_android" target="_blank" rel="noopener">http://push.baidu.com/sdk/push_client_sdk_for_android</a></p>
<h3 id="在百度应用中心创建应用"><a href="#在百度应用中心创建应用" class="headerlink" title="在百度应用中心创建应用"></a>在百度应用中心创建应用</h3><p>创建应用不需要传递代码等东西，只是为了获取百度的关联关系<br>创建应用之后能得到API KEY和SECRET KEY，apikey是标志，客户端和服务端都会配置这个key，然后百度云端才能找到对应的app。<br>创建应用的地址如下<a href="http://push.baidu.com/console/app" target="_blank" rel="noopener">http://push.baidu.com/console/app</a></p>
<h3 id="Android"><a href="#Android" class="headerlink" title="Android"></a>Android</h3><p>官方参考文档 <a href="http://push.baidu.com/doc/android/api" target="_blank" rel="noopener">http://push.baidu.com/doc/android/api</a></p>
<p>主要流程<br>绑定到百度云通知服务，和接收云通知。</p>
<p>1 通过<code>PushManager</code>启动推送,关联到百度云</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 在当前工程的主Activity的onCreate函数中，添加以下代码：</span><br><span class="line">PushManager.startWork(getApplicationContext(),PushConstants.LOGIN_TYPE_API_KEY,&quot;api_key&quot;)</span><br></pre></td></tr></table></figure>
<p>2 继承<code>PushMessageReceiver</code>来创建接收请求类<br>其中一些主要的方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 调用PushManager.startWork后，sdk将对push server发起绑定请求，这个过程是异步的。绑定请求的结果通过onBind返回。 如果您需要用单播推送，需要把这里获取的channel id和user id上传到应用server中，再调用server接口用channel id和user id给单个手机或者用户推送。</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onBind</span><span class="params">(Context context, <span class="keyword">int</span> errorCode, String appid, String userId, String channelId, String requestId)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//接收透传消息的函数-- onMessage</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onMessage</span><span class="params">(Context context, String message, String customContentString)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//通知到达时，当通知被用户点击时，会回调onNotificationClicked函数</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onNotificationClicked</span><span class="params">(Context context, String title, String description, String customContentString)</span></span></span><br></pre></td></tr></table></figure>
<h3 id="IOS"><a href="#IOS" class="headerlink" title="IOS"></a>IOS</h3><p><em>因为ios需要开发者证书（个人版一年688rmb），未进行ios的测试。</em></p>
<h3 id="服务端api"><a href="#服务端api" class="headerlink" title="服务端api"></a>服务端api</h3><h4 id="api参考地址"><a href="#api参考地址" class="headerlink" title="api参考地址"></a>api参考地址</h4><p><a href="http://push.baidu.com/doc/java/api" target="_blank" rel="noopener">http://push.baidu.com/doc/java/api</a></p>
<p>都是一些调用推送例子，一目了然。</p>
<ul>
<li>定时推送<br>定时推送的sendtime参数，是根据时间戳来进行的，只能指定时间之后定时发送一次，如果做复杂点的，指定时间重复推送，需要后台自己实现定时方法来调用。   </li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 设置定时推送时间，必需超过当前时间一分钟，单位秒.实例70秒后推送</span></span><br><span class="line"> addSendTime(System.currentTimeMillis() / <span class="number">1000</span> + <span class="number">70</span>).</span><br></pre></td></tr></table></figure>
<h4 id="单个推送举例"><a href="#单个推送举例" class="headerlink" title="单个推送举例"></a>单个推送举例</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.baidu.yun.push.sample;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baidu.yun.core.log.YunLogEvent;</span><br><span class="line"><span class="keyword">import</span> com.baidu.yun.core.log.YunLogHandler;</span><br><span class="line"><span class="keyword">import</span> com.baidu.yun.push.auth.PushKeyPair;</span><br><span class="line"><span class="keyword">import</span> com.baidu.yun.push.client.BaiduPushClient;</span><br><span class="line"><span class="keyword">import</span> com.baidu.yun.push.constants.BaiduPushConstants;</span><br><span class="line"><span class="keyword">import</span> com.baidu.yun.push.exception.PushClientException;</span><br><span class="line"><span class="keyword">import</span> com.baidu.yun.push.exception.PushServerException;</span><br><span class="line"><span class="keyword">import</span> com.baidu.yun.push.model.PushMsgToSingleDeviceRequest;</span><br><span class="line"><span class="keyword">import</span> com.baidu.yun.push.model.PushMsgToSingleDeviceResponse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PushMsgToSingleDevice</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> PushClientException,PushServerException </span>&#123;</span><br><span class="line">        <span class="comment">/*1. 创建PushKeyPair</span></span><br><span class="line"><span class="comment">         *用于app的合法身份认证</span></span><br><span class="line"><span class="comment">         *apikey和secretKey可在应用详情中获取</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        String apiKey = “xxxxxxxxxxxxxxxxxxxxxx”;</span><br><span class="line">        String secretKey = “xxxxxxxxxxxxxxxxxxxxxx”;</span><br><span class="line">        PushKeyPair pair = <span class="keyword">new</span> PushKeyPair(apiKey,secretKey);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2. 创建BaiduPushClient，访问SDK接口</span></span><br><span class="line">        BaiduPushClient pushClient = <span class="keyword">new</span> BaiduPushClient(pair,</span><br><span class="line">                BaiduPushConstants.CHANNEL_REST_URL);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3. 注册YunLogHandler，获取本次请求的交互信息</span></span><br><span class="line">        pushClient.setChannelLogHandler (<span class="keyword">new</span> YunLogHandler () &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onHandle</span> <span class="params">(YunLogEvent event)</span> </span>&#123;</span><br><span class="line">                System.out.println(event.getMessage());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// 4. 设置请求参数，创建请求实例</span></span><br><span class="line">            PushMsgToSingleDeviceRequest request = <span class="keyword">new</span> PushMsgToSingleDeviceRequest().</span><br><span class="line">                addChannelId(<span class="string">"xxxxxxxxxxxxxxxxxx"</span>).</span><br><span class="line">                addMsgExpires(<span class="keyword">new</span> Integer(<span class="number">3600</span>)).   <span class="comment">//设置消息的有效时间,单位秒,默认3600*5.</span></span><br><span class="line">                addMessageType(<span class="number">1</span>).              <span class="comment">//设置消息类型,0表示透传消息,1表示通知,默认为0.</span></span><br><span class="line">                add(<span class="string">"&#123;\"title\":\"TEST\",\"description\":\"Hello Baidu push!\"&#125;"</span>).</span><br><span class="line">                addDeviceType(<span class="number">3</span>);      <span class="comment">//设置设备类型，deviceType =&gt; 1 for web, 2 for pc, </span></span><br><span class="line">                                       <span class="comment">//3 for android, 4 for ios, 5 for wp.</span></span><br><span class="line">        <span class="comment">// 5. 执行Http请求</span></span><br><span class="line">            PushMsgToSingleDeviceResponse response = pushClient.</span><br><span class="line">                pushMsgToSingleDevice(request);</span><br><span class="line">        <span class="comment">// 6. Http请求返回值解析</span></span><br><span class="line">            System.out.println(<span class="string">"msgId: "</span> + response.getMsgId()</span><br><span class="line">                    + <span class="string">",sendTime: "</span> + response.getSendTime());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (PushClientException e) &#123;</span><br><span class="line">            <span class="comment">//ERROROPTTYPE 用于设置异常的处理方式 -- 抛出异常和捕获异常,</span></span><br><span class="line">            <span class="comment">//'true' 表示抛出, 'false' 表示捕获。</span></span><br><span class="line">            <span class="keyword">if</span> (BaiduPushConstants.ERROROPTTYPE) &#123; </span><br><span class="line">                <span class="keyword">throw</span> e;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (PushServerException e) &#123;</span><br><span class="line">            <span class="keyword">if</span> (BaiduPushConstants.ERROROPTTYPE) &#123;</span><br><span class="line">                <span class="keyword">throw</span> e;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(String.format(</span><br><span class="line">                        <span class="string">"requestId: %d, errorCode: %d, errorMsg: %s"</span>,</span><br><span class="line">                        e.getRequestId(), e.getErrorCode(), e.getErrorMsg()));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="网络通讯"><a href="#网络通讯" class="headerlink" title="网络通讯"></a>网络通讯</h4><p>百度云提供的接口是以REST API协议发布的，依托http+json形式。</p>
<p>上述第二步的 BaiduPushClient，配置了服务端与百度云通信的访问域名<br>有2个可选<code>api.push.baidu.com</code>；<code>api.tuisong.baidu.com</code></p>
<p>真实拼凑的访问百度云推送接口地址代码如下。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> String <span class="title">obtainIntegrityUrl</span><span class="params">(String classType, String method)</span> </span>&#123;</span><br><span class="line">   String resurl = host;</span><br><span class="line">   <span class="keyword">if</span> (host.startsWith(<span class="string">"http://"</span>) || host.startsWith(<span class="string">"https://"</span>)) &#123;</span><br><span class="line">   &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      resurl = <span class="string">"http://"</span> + host;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">if</span> (resurl.endsWith(<span class="string">"/"</span>)) &#123;</span><br><span class="line">      resurl = resurl + <span class="string">"rest/3.0/"</span>;</span><br><span class="line">   &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      resurl = resurl + <span class="string">"/rest/3.0/"</span>;</span><br><span class="line">   &#125;</span><br><span class="line">   resurl = resurl + classType + <span class="string">"/"</span> + method;</span><br><span class="line">   <span class="keyword">return</span> resurl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>由代码可知，需要访问<code>api.push.baidu.com</code>或<code>api.tuisong.baidu.com</code>域名的80端口，走http协议。默认使用http模式。如果服务器网络架构问题需要做代理就对这个地址和端口做对应处理（由于家里环境问题没有成功模拟出来，但是它走接口的形势就是http请求的，公司有类似项目的情况一样的都能一样的处理）。</p>
<h2 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h2><p>####通知和透传消息的区别？<br>通知会直接在通知栏弹出展示，消息则由应用控制。</p>
<p>####应用关闭或结束进程后，还能收到推送吗？<br>应用退至后台或结束进程，百度云推送的Service会继续在后台运行并接收推送；部分情况下使用安全软件或内存管理工具强制清理后台，Service会被清除，但会快速重启；在小米和魅族手机上，用户清理后台应用后必须要等到再次打开app，开发者调用StartWork之后，Service才会在后台启动并继续接收推送。</p>
<h2 id="行业对比和评测"><a href="#行业对比和评测" class="headerlink" title="行业对比和评测"></a>行业对比和评测</h2><p>以上是本人分析的百度云推送接入方式，和细节，android虚拟机测试时,消息也是瞬间到达的。</p>
<p>评测<a href="http://www.devstore.cn/evaluation/testInfo/119-180.html" target="_blank" rel="noopener">http://www.devstore.cn/evaluation/testInfo/119-180.html</a></p>
<p>知乎对比 <a href="https://www.zhihu.com/question/20628786" target="_blank" rel="noopener">https://www.zhihu.com/question/20628786</a></p>

      
    </div>

    
      
      

  <div class="post-copyright">
    <p class="copyright-item">
      <span>原文作者: </span>
      <a href="http://www.sitec.cc">keeleys</a>
    </p>
    <p class="copyright-item">
      <span>原文链接: </span>
      <a href="http://www.sitec.cc/2016/01/09/baidupush/">http://www.sitec.cc/2016/01/09/baidupush/</a>
    </p>
    <p class="copyright-item">
      <span>许可协议: </span>
      
      <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank">知识共享署名-非商业性使用 4.0 国际许可协议</a>
    </p>
  </div>



      
      
    

    
      <footer class="post-footer">
        
          <div class="post-tags">
            
              <a href="/tags/技术分析/">技术分析</a>
            
          </div>
        
        
        
  <nav class="post-nav">
    
      <a class="prev" href="/2016/01/14/dubbo-test/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">dubbo介绍和集成例子</span>
        <span class="prev-text nav-mobile">上一篇</span>
      </a>
    
    
      <a class="next" href="/2015/12/15/m1ic/">
        <span class="next-text nav-default">非接触储存卡M1卡分析</span>
        <span class="prev-text nav-mobile">下一篇</span>
        <i class="iconfont icon-right"></i>
      </a>
    
  </nav>

      </footer>
    

  </article>


          </div>
          
  <div class="comments" id="comments">
    
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    
  </div>


        </div>
      </main>

      <footer id="footer" class="footer">

  <div class="social-links">
    
      
        
          <a href="mailto:your@email.com" class="iconfont icon-email" title="email"></a>
        
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
    
    
      
      <a href="/atom.xml" class="iconfont icon-rss" title="rss"></a>
    
  </div>


<div class="copyright">
  <span class="copyright-year">
    
    &copy; 
     
      2015 - 
    
    2018

    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">keeleys</span>
  </span>
</div>

      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>

    
  
  <script type="text/javascript">
    var disqus_config = function () {
        this.page.url = 'http://www.sitec.cc/2016/01/09/baidupush/';
        this.page.identifier = '2016/01/09/baidupush/';
        this.page.title = '百度云推送分析';
    };
    (function() {
    var d = document, s = d.createElement('script');

    s.src = '//sitecc.disqus.com/embed.js';

    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();  
  </script>

  

  



    




  
    <script type="text/javascript" src="/lib/jquery/jquery-3.1.1.min.js"></script>
  

  
    <script type="text/javascript" src="/lib/slideout/slideout.js"></script>
  

  


    <script type="text/javascript" src="/js/src/even.js?v=2.6.0"></script>
<script type="text/javascript" src="/js/src/bootstrap.js?v=2.6.0"></script>

  </body>
</html>
