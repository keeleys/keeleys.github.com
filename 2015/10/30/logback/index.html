<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    
<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">



  <meta name="description" content="java logback"/>




  <meta name="keywords" content="java logback" />










  <link rel="alternate" href="/default" title="凉水">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2.6.0" />



<link rel="canonical" href="http://www.sitec.cc/2015/10/30/logback/"/>


<link rel="stylesheet" type="text/css" href="/css/style.css?v=2.6.0" />






  



  <script id="baidu_push">
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>









    <title> 使用logback记录日志 - 凉水 </title>
  </head>

  <body><div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/." class="logo">凉水</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    
      <a href="/">
        <li class="mobile-menu-item">
          
          
            首页
          
        </li>
      </a>
    
      <a href="/archives/">
        <li class="mobile-menu-item">
          
          
            归档
          
        </li>
      </a>
    
  </ul>
</nav>

    <div class="container" id="mobile-panel">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">凉水</a>
</div>

<nav class="site-navbar">
  
    <ul id="menu" class="menu">
      
        <li class="menu-item">
          <a class="menu-item-link" href="/">
            
            
              首页
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/archives/">
            
            
              归档
            
          </a>
        </li>
      
    </ul>
  
</nav>

      </header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content">
            
  
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          使用logback记录日志
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2015-10-30
        </span>
        
          <div class="post-category">
            
              <a href="/categories/java/">java</a>
            
          </div>
        
        
      </div>
    </header>

    
    
  <div class="post-toc" id="post-toc">
    <h2 class="post-toc-title">文章目录</h2>
    <div class="post-toc-content">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#logback-优点"><span class="toc-text">logback 优点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#配置logback环境"><span class="toc-text">配置logback环境</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#加载包"><span class="toc-text">加载包</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#配置文件logback-xml"><span class="toc-text">配置文件logback.xml</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#java类中使用"><span class="toc-text">java类中使用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#logback-xml-基础配置"><span class="toc-text">logback.xml 基础配置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#configuration"><span class="toc-text">configuration</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#contextName"><span class="toc-text">contextName</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#property"><span class="toc-text">property</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#timestamp"><span class="toc-text">timestamp</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#appender"><span class="toc-text">appender</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#loger"><span class="toc-text">loger</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#appender-ref"><span class="toc-text">appender-ref</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#root"><span class="toc-text">root</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#最简单的配置"><span class="toc-text">最简单的配置</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Appender-详细描述"><span class="toc-text">Appender 详细描述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ConsoleAppender"><span class="toc-text">ConsoleAppender</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FileAppender"><span class="toc-text">FileAppender</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RollingFileAppender"><span class="toc-text">RollingFileAppender</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#rollingPolicy"><span class="toc-text">rollingPolicy</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#TimeBasedRollingPolicy"><span class="toc-text">TimeBasedRollingPolicy</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#FixedWindowRollingPolicy"><span class="toc-text">FixedWindowRollingPolicy</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#triggeringPolicy"><span class="toc-text">triggeringPolicy</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#SizeBasedTriggeringPolicy"><span class="toc-text">SizeBasedTriggeringPolicy</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#encoder-详细"><span class="toc-text">encoder 详细</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#logger-c-lo"><span class="toc-text">logger,c,lo</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#C-class"><span class="toc-text">C,class</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#contextName-cn-输出上下文名称"><span class="toc-text">contextName,cn 输出上下文名称</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#d-date"><span class="toc-text">d ,date</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#F-file"><span class="toc-text">F / file</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#caller-depth"><span class="toc-text">caller{depth}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#L-line"><span class="toc-text">L / line</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#m-msg-message"><span class="toc-text">m / msg / message</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#M-method"><span class="toc-text">M / method</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#n"><span class="toc-text">n</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#p-le-level"><span class="toc-text">p / le / level</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#r-relative"><span class="toc-text">r / relative</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#t-thread"><span class="toc-text">t / thread</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#replace-p-r-t"><span class="toc-text">replace(p ){r, t}</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#filter"><span class="toc-text">filter</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#LevelFilter"><span class="toc-text">LevelFilter</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ThresholdFilter"><span class="toc-text">ThresholdFilter</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EvaluatorFilter"><span class="toc-text">EvaluatorFilter</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#补充"><span class="toc-text">补充</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#例子"><span class="toc-text">例子</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#db日志的建表语句"><span class="toc-text">db日志的建表语句</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#分文件保存日志"><span class="toc-text">分文件保存日志</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#log4j-转logback"><span class="toc-text">log4j 转logback</span></a></li></ol>
    </div>
  </div>


    <div class="post-content">
      
        <h2 id="logback-优点"><a href="#logback-优点" class="headerlink" title="logback 优点"></a>logback 优点</h2><ul>
<li>自定义日志级别过滤，日志名过滤输出到不同的文件</li>
<li>号称速度是log4j的十倍</li>
<li>可以配置到数据库</li>
<li>SLF4J的实现，切换日志组建比较方便。</li>
<li>自动重新载入配置文件</li>
<li>文件管理更加强大， 自动清除旧的日志归档文件，自动压缩归档日志文件</li>
<li>SiftingAppender,基于任何给定的实时属性分开（或者筛选）日志。例如，SiftingAppender可以基于用户会话分开日志事件</li>
</ul>
<a id="more"></a>
<h2 id="配置logback环境"><a href="#配置logback环境" class="headerlink" title="配置logback环境"></a>配置logback环境</h2><h3 id="加载包"><a href="#加载包" class="headerlink" title="加载包"></a>加载包</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>ch.qos.logback<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>logback-classic<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="配置文件logback-xml"><a href="#配置文件logback-xml" class="headerlink" title="配置文件logback.xml"></a>配置文件logback.xml</h3><p>在工程src目录下建立logback.xml</p>
<ol>
<li>logback首先会试着查找logback.groovy文件;</li>
<li>当没有找到时，继续试着查找logback-test.xml文件;</li>
<li>当没有找到时，继续试着查找logback.xml文件;</li>
<li>如果仍然没有找到，则使用默认配置（打印到控制台）</li>
</ol>
<h3 id="java类中使用"><a href="#java类中使用" class="headerlink" title="java类中使用"></a>java类中使用</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">import org.slf4j.Logger;  </span><br><span class="line">import org.slf4j.LoggerFactory; </span><br><span class="line"></span><br><span class="line">private static Logger log = LoggerFactory.getLogger(Test.class);</span><br></pre></td></tr></table></figure>
<h2 id="logback-xml-基础配置"><a href="#logback-xml-基础配置" class="headerlink" title="logback.xml 基础配置"></a>logback.xml 基础配置</h2><h3 id="configuration"><a href="#configuration" class="headerlink" title="configuration"></a>configuration</h3><blockquote>
<p>根节点<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span> <span class="attr">scan</span>=<span class="string">"true"</span> <span class="attr">scanPeriod</span>=<span class="string">"60 seconds"</span> <span class="attr">debug</span>=<span class="string">"false"</span>&gt;</span>  </span><br><span class="line">      <span class="comment">&lt;!-- 其他配置省略--&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
</blockquote>
<ul>
<li><code>scan</code>: 当此属性设置为true时，配置文件如果发生改变，将会被重新加载，默认值为true。</li>
<li><code>scanPeriod</code>: 设置监测配置文件是否有修改的时间间隔，如果没有给出时间单位，默认单位是毫秒。当scan为true时，此属性生效。默认的时间间隔为1分钟。</li>
<li><code>debug</code>: 当此属性设置为true时，将打印出logback内部日志信息，实时查看logback运行状态。默认值为false。</li>
</ul>
<h3 id="contextName"><a href="#contextName" class="headerlink" title="contextName"></a>contextName</h3><blockquote>
<p>每个logger都关联到logger上下文，默认上下文名称为“default”,用于区分不同应用程序的记录。</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span> <span class="attr">scan</span>=<span class="string">"true"</span> <span class="attr">scanPeriod</span>=<span class="string">"60 seconds"</span> <span class="attr">debug</span>=<span class="string">"false"</span>&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;<span class="name">contextName</span>&gt;</span>appName<span class="tag">&lt;/<span class="name">contextName</span>&gt;</span>  </span><br><span class="line">      <span class="comment">&lt;!-- 其他配置省略--&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="property"><a href="#property" class="headerlink" title="property"></a>property</h3><blockquote>
<p>用来定义变量值的标签<br><code>property</code> 有两个属性，name和value；其中name的值是变量的名称，value的值时变量定义的值</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"APP_Name"</span> <span class="attr">value</span>=<span class="string">"myAppName"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="timestamp"><a href="#timestamp" class="headerlink" title="timestamp"></a>timestamp</h3><blockquote>
<p>将解析配置文件的时间作为上下文名称</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">timestamp</span> <span class="attr">key</span>=<span class="string">"bySecond"</span> <span class="attr">datePattern</span>=<span class="string">"yyyyMMdd'T'HHmmss"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="appender"><a href="#appender" class="headerlink" title="appender"></a>appender</h3><blockquote>
<p>日志的输出配置，比如<code>ConsoleAppender</code>,<code>FileAppender</code>等</p>
</blockquote>
<h3 id="loger"><a href="#loger" class="headerlink" title="loger"></a>loger</h3><blockquote>
<p>用来设置某一个包或者具体的某一个类的日志打印级别、以及指定<appender></appender></p>
</blockquote>
<ul>
<li><code>name</code>:用来指定受此loger约束的某一个包或者具体的某一个类。</li>
<li><code>level</code> 用来设置打印级别，大小写无关,TRACE, DEBUG, INFO, WARN, ERROR, ALL 和 OFF,如果未设置此属性，那么当前loger将会继承上级的级别</li>
<li><code>addtivity</code> 是否向上级loger传递打印信息。默认是true</li>
</ul>
<h4 id="appender-ref"><a href="#appender-ref" class="headerlink" title="appender-ref"></a>appender-ref</h4><blockquote>
<p>loger下面可以包含多个appender-ref标签<br>标识这个appender将会添加到这个loger</p>
</blockquote>
<h3 id="root"><a href="#root" class="headerlink" title="root"></a>root</h3><blockquote>
<p>特殊的loger元素，根loger，只有一个level属性<br>日志级别 <code>TRACE</code>, <code>DEBUG</code>, <code>INFO</code>, <code>WARN</code>, <code>ERROR</code></p>
</blockquote>
<h3 id="最简单的配置"><a href="#最简单的配置" class="headerlink" title="最简单的配置"></a>最简单的配置</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span>   </span><br><span class="line">   </span><br><span class="line">  <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">"STDOUT"</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.core.ConsoleAppender"</span>&gt;</span>   </span><br><span class="line">    <span class="comment">&lt;!-- encoder 默认配置为PatternLayoutEncoder --&gt;</span>   </span><br><span class="line">    <span class="tag">&lt;<span class="name">encoder</span>&gt;</span>   </span><br><span class="line">      <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>%d&#123;HH:mm:ss.SSS&#125; [%thread] %-5level %logger&#123;36&#125; - %msg%n<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span>   </span><br><span class="line">      <span class="tag">&lt;<span class="name">charset</span>&gt;</span>utf-8<span class="tag">&lt;/<span class="name">charset</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span>   </span><br><span class="line">  <span class="tag">&lt;/<span class="name">appender</span>&gt;</span>   </span><br><span class="line">   </span><br><span class="line">  <span class="tag">&lt;<span class="name">root</span> <span class="attr">level</span>=<span class="string">"INFO"</span>&gt;</span>             </span><br><span class="line">    <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">"STDOUT"</span> /&gt;</span>   </span><br><span class="line">  <span class="tag">&lt;/<span class="name">root</span>&gt;</span>     </span><br><span class="line">     </span><br><span class="line"> <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="Appender-详细描述"><a href="#Appender-详细描述" class="headerlink" title="Appender 详细描述"></a>Appender 详细描述</h2><h3 id="ConsoleAppender"><a href="#ConsoleAppender" class="headerlink" title="ConsoleAppender"></a>ConsoleAppender</h3><blockquote>
<p>控制台日志<br>以下子节点<br><code>&lt;encoder&gt;</code>：对日志进行格式化。（具体参数稍后讲解 ）<br><code>&lt;target&gt;</code>：字符串 System.out 或者 System.err ，默认 System.out </p>
</blockquote>
<h3 id="FileAppender"><a href="#FileAppender" class="headerlink" title="FileAppender"></a>FileAppender</h3><blockquote>
<p>把日志添加到文件</p>
</blockquote>
<ul>
<li><code>file</code> 被写入的文件名,如果上级目录不存在会自动创建，没有默认值。</li>
<li><code>append</code> 如果是 true，日志被追加到文件结尾，如果是 false，清空现存文件，默认是true</li>
<li><code>encoder</code> 格式化日志</li>
<li><code>prudent</code> 如果是 true，日志会被安全的写入文件，即使其他的FileAppender也在向此文件做写入操作，效率低，默认是 false。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;configuration&gt;  </span><br><span class="line">  &lt;appender name=&quot;FILE&quot; class=&quot;ch.qos.logback.core.FileAppender&quot;&gt;  </span><br><span class="line">    &lt;file&gt;testFile.log&lt;/file&gt;  </span><br><span class="line">    &lt;append&gt;true&lt;/append&gt;  </span><br><span class="line">    &lt;encoder&gt;  </span><br><span class="line">      &lt;pattern&gt;%-4relative [%thread] %-5level %logger&#123;35&#125; - %msg%n&lt;/pattern&gt;  </span><br><span class="line">    &lt;/encoder&gt;  </span><br><span class="line">  &lt;/appender&gt;    </span><br><span class="line">  &lt;root level=&quot;DEBUG&quot;&gt;  </span><br><span class="line">    &lt;appender-ref ref=&quot;FILE&quot; /&gt;  </span><br><span class="line">  &lt;/root&gt;  </span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure>
<h3 id="RollingFileAppender"><a href="#RollingFileAppender" class="headerlink" title="RollingFileAppender"></a>RollingFileAppender</h3><blockquote>
<p>滚动记录文件，先将日志记录到指定文件，当符合某个条件时，将日志记录到其他文件</p>
<ul>
<li>共同的配置见 <code>FileAppender</code>描述</li>
<li><code>rollingPolicy</code> 当发生滚动时，决定 RollingFileAppender 的行为，涉及文件移动和重命名</li>
<li><code>triggeringPolicy</code>  告知 RollingFileAppender 何时激活滚动</li>
</ul>
</blockquote>
<h4 id="rollingPolicy"><a href="#rollingPolicy" class="headerlink" title="rollingPolicy"></a>rollingPolicy</h4><h5 id="TimeBasedRollingPolicy"><a href="#TimeBasedRollingPolicy" class="headerlink" title="TimeBasedRollingPolicy"></a>TimeBasedRollingPolicy</h5><blockquote>
<p>根据时间来制定滚动策略</p>
</blockquote>
<ul>
<li><code>fileNamePattern</code> 必要节点，包含文件名及“%d”转换符</li>
<li><code>maxHistory</code> 可选节点，控制保留的归档文件的最大数量，超出数量就删除旧文件</li>
</ul>
<h5 id="FixedWindowRollingPolicy"><a href="#FixedWindowRollingPolicy" class="headerlink" title="FixedWindowRollingPolicy"></a>FixedWindowRollingPolicy</h5><blockquote>
<p>根据固定窗口算法重命名文件的滚动策略</p>
<ul>
<li><code>minIndex</code> 窗口索引最小值</li>
<li><code>maxIndex</code> 窗口索引最大值</li>
<li><code>fileNamePattern</code>  必须包含“%i”例如，假设最小值和最大值分别为1和2，命名模式为 mylog%i.log,会产生归档文件</li>
</ul>
</blockquote>
<h4 id="triggeringPolicy"><a href="#triggeringPolicy" class="headerlink" title="triggeringPolicy"></a>triggeringPolicy</h4><h5 id="SizeBasedTriggeringPolicy"><a href="#SizeBasedTriggeringPolicy" class="headerlink" title="SizeBasedTriggeringPolicy"></a>SizeBasedTriggeringPolicy</h5><blockquote>
<p>查看当前活动文件的大小，如果超过指定大小会告知 RollingFileAppender 触发当前活动文件滚动</p>
</blockquote>
<ul>
<li><code>maxFileSize</code> 这是活动文件的大小，默认值是10MB</li>
</ul>
<h2 id="encoder-详细"><a href="#encoder-详细" class="headerlink" title="encoder 详细"></a>encoder 详细</h2><blockquote>
<p>负责两件事，一是把日志信息转换成字节数组，二是把字节数组写入到输出流。<br>使用“%”加“转换符”方式，如果要输出“%”，则必须用“\”对“\%”进行转义<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;encoder&gt;   </span><br><span class="line">   &lt;pattern&gt;%-4relative [%thread] %-5level %logger&#123;35&#125; - %msg%n&lt;/pattern&gt;   </span><br><span class="line">&lt;/encoder</span><br></pre></td></tr></table></figure></p>
</blockquote>
<h3 id="logger-c-lo"><a href="#logger-c-lo" class="headerlink" title="logger,c,lo"></a>logger,c,lo</h3><blockquote>
<p>输出日志的logger名，可有一个整形参数，功能是缩短logger名</p>
</blockquote>
<table>
<thead>
<tr>
<th>%logger</th>
<th>mainPackage.sub.sample.Bar</th>
<th>mainPackage.sub.sample.Bar</th>
</tr>
</thead>
<tbody>
<tr>
<td>%logger{0}</td>
<td>mainPackage.sub.sample.Bar</td>
<td>Bar</td>
</tr>
<tr>
<td>%logger{5}</td>
<td>mainPackage.sub.sample.Bar</td>
<td>m.s.s.Bar</td>
</tr>
<tr>
<td>%logger{16}</td>
<td>mainPackage.sub.sample.Bar</td>
<td>m.sub.sample.Bar</td>
</tr>
</tbody>
</table>
<h3 id="C-class"><a href="#C-class" class="headerlink" title="C,class"></a>C,class</h3><h3 id="contextName-cn-输出上下文名称"><a href="#contextName-cn-输出上下文名称" class="headerlink" title="contextName,cn 输出上下文名称"></a>contextName,cn 输出上下文名称</h3><h3 id="d-date"><a href="#d-date" class="headerlink" title="d ,date"></a>d ,date</h3><blockquote>
<p>输出日志的打印日志，模式语法与java.text.SimpleDateFormat 兼容。 </p>
</blockquote>
<ul>
<li>%date{dd MMM yyyy ;HH:mm:ss.SSS}</li>
<li>%date{HH:mm:ss.SSS}</li>
<li>%date{ISO8601}</li>
</ul>
<h3 id="F-file"><a href="#F-file" class="headerlink" title="F / file"></a>F / file</h3><blockquote>
<p>输出执行记录请求的java源文件名。尽量避免使用，除非执行速度不造成任何问题</p>
</blockquote>
<h3 id="caller-depth"><a href="#caller-depth" class="headerlink" title="caller{depth}"></a>caller{depth}</h3><blockquote>
<p>输出生成日志的调用者的代码执行位置信息，整数选项表示输出信息深度</p>
</blockquote>
<h3 id="L-line"><a href="#L-line" class="headerlink" title="L / line"></a>L / line</h3><blockquote>
<p>输出执行日志请求的行号。尽量避免使用，除非执行速度不造成任何问题。</p>
</blockquote>
<h3 id="m-msg-message"><a href="#m-msg-message" class="headerlink" title="m / msg / message"></a>m / msg / message</h3><blockquote>
<p>输出应用程序提供的信息。</p>
</blockquote>
<h3 id="M-method"><a href="#M-method" class="headerlink" title="M / method"></a>M / method</h3><blockquote>
<p>输出执行日志请求的方法名。尽量避免使用，除非执行速度不造成任何问题。</p>
</blockquote>
<h3 id="n"><a href="#n" class="headerlink" title="n"></a>n</h3><blockquote>
<p>输出平台先关的分行符“\n”或者“\r\n”。</p>
</blockquote>
<h3 id="p-le-level"><a href="#p-le-level" class="headerlink" title="p / le / level"></a>p / le / level</h3><blockquote>
<p>输出日志级别。</p>
</blockquote>
<h3 id="r-relative"><a href="#r-relative" class="headerlink" title="r / relative"></a>r / relative</h3><blockquote>
<p>输出从程序启动到创建日志记录的时间，单位是毫秒</p>
</blockquote>
<h3 id="t-thread"><a href="#t-thread" class="headerlink" title="t / thread"></a>t / thread</h3><blockquote>
<p>输出产生日志的线程名</p>
</blockquote>
<h3 id="replace-p-r-t"><a href="#replace-p-r-t" class="headerlink" title="replace(p ){r, t}"></a>replace(p ){r, t}</h3><blockquote>
<p>p 为日志内容，r 是正则表达式，将p 中符合r 的内容替换为t 。<br>例如， “%replace(%msg){‘\s’, ‘’}”</p>
</blockquote>
<h2 id="filter"><a href="#filter" class="headerlink" title="filter"></a>filter</h2><h3 id="LevelFilter"><a href="#LevelFilter" class="headerlink" title="LevelFilter"></a>LevelFilter</h3><blockquote>
<p>级别过滤器，根据日志级别进行过滤<br>如果日志级别等于配置级别，过滤器会根据onMath 和 onMismatch接收或拒绝日志</p>
</blockquote>
<ul>
<li><code>level</code> 设置过滤级别 TRACE, DEBUG, INFO, WARN, ERROR</li>
<li><code>onMatch</code> 用于配置符合过滤条件的操作,ACCEPT,DENY,NEUTRAL</li>
<li>用于配置不符合过滤条件的操作</li>
</ul>
<h3 id="ThresholdFilter"><a href="#ThresholdFilter" class="headerlink" title="ThresholdFilter"></a>ThresholdFilter</h3><blockquote>
<p>临界值过滤器，过滤掉低于指定临界值的日志。</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 过滤掉 TRACE 和 DEBUG 级别的日志--&gt;</span>   </span><br><span class="line"><span class="tag">&lt;<span class="name">filter</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.classic.filter.ThresholdFilter"</span>&gt;</span>   </span><br><span class="line">  <span class="tag">&lt;<span class="name">level</span>&gt;</span>INFO<span class="tag">&lt;/<span class="name">level</span>&gt;</span>   </span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="EvaluatorFilter"><a href="#EvaluatorFilter" class="headerlink" title="EvaluatorFilter"></a>EvaluatorFilter</h3><blockquote>
<p>求值过滤器，评估、鉴别日志是否符合指定条件<br> 需要额外的两个JAR包，commons-compiler.jar和janino.jar<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;filter class=&quot;ch.qos.logback.core.filter.EvaluatorFilter&quot;&gt;         </span><br><span class="line">  &lt;evaluator&gt; &lt;!-- 默认为 ch.qos.logback.classic.boolex.JaninoEventEvaluator --&gt;   </span><br><span class="line">    &lt;expression&gt;return message.contains(&quot;billing&quot;);&lt;/expression&gt;   </span><br><span class="line">  &lt;/evaluator&gt;   </span><br><span class="line">  &lt;OnMatch&gt;ACCEPT &lt;/OnMatch&gt;  </span><br><span class="line">  &lt;OnMismatch&gt;DENY&lt;/OnMismatch&gt;  </span><br><span class="line">&lt;/filter&gt;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<h2 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h2><h3 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">    Copyright 2010-2011 The myBatis Team</span></span><br><span class="line"><span class="comment">    Licensed under the Apache License, Version 2.0 (the "License");</span></span><br><span class="line"><span class="comment">    you may not use this file except in compliance with the License.</span></span><br><span class="line"><span class="comment">    You may obtain a copy of the License at</span></span><br><span class="line"><span class="comment">        http://www.apache.org/licenses/LICENSE-2.0</span></span><br><span class="line"><span class="comment">    Unless required by applicable law or agreed to in writing, software</span></span><br><span class="line"><span class="comment">    distributed under the License is distributed on an "AS IS" BASIS,</span></span><br><span class="line"><span class="comment">    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></span><br><span class="line"><span class="comment">    See the License for the specific language governing permissions and</span></span><br><span class="line"><span class="comment">    limitations under the License.</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span> <span class="attr">debug</span>=<span class="string">"false"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">contextName</span>&gt;</span>weixin-web<span class="tag">&lt;/<span class="name">contextName</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--定义日志文件的存储地址 勿在 LogBack 的配置中使用相对路径--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"LOG_HOME"</span> <span class="attr">value</span>=<span class="string">"C:\\home\\log\\weixin"</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 控制台输出 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">"STDOUT"</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.core.ConsoleAppender"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.classic.encoder.PatternLayoutEncoder"</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--格式化输出：%d表示日期，%thread表示线程名，%-5level：级别从左显示5个字符宽度%msg：日志消息，%n是换行符--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>%-4relative %date [%thread] %-5level %logger&#123;50&#125; - %msg%n<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 按照每天生成日志文件 --&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">"INFO_FILE"</span>  <span class="attr">class</span>=<span class="string">"ch.qos.logback.core.rolling.RollingFileAppender"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.classic.filter.LevelFilter"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">level</span>&gt;</span>ERROR<span class="tag">&lt;/<span class="name">level</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">onMatch</span>&gt;</span>DENY<span class="tag">&lt;/<span class="name">onMatch</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">onMismatch</span>&gt;</span>ACCEPT<span class="tag">&lt;/<span class="name">onMismatch</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">rollingPolicy</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.core.rolling.TimeBasedRollingPolicy"</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--日志文件输出的文件名--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">FileNamePattern</span>&gt;</span>$&#123;LOG_HOME&#125;/INFO.log.%d&#123;yyyy-MM-dd&#125;.log<span class="tag">&lt;/<span class="name">FileNamePattern</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--日志文件保留天数--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">MaxHistory</span>&gt;</span>30<span class="tag">&lt;/<span class="name">MaxHistory</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">rollingPolicy</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.classic.encoder.PatternLayoutEncoder"</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--格式化输出：%d表示日期，%thread表示线程名，%-5level：级别从左显示5个字符宽度%msg：日志消息，%n是换行符--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>%-4relative %date [%thread] %-5level %logger&#123;50&#125; - %msg%n<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--日志文件最大的大小--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">triggeringPolicy</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.core.rolling.SizeBasedTriggeringPolicy"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">MaxFileSize</span>&gt;</span>100MB<span class="tag">&lt;/<span class="name">MaxFileSize</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">triggeringPolicy</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">"ERR_FILE"</span>  <span class="attr">class</span>=<span class="string">"ch.qos.logback.core.rolling.RollingFileAppender"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">       返回DENY，日志将立即被抛弃不再经过其他过滤器；</span></span><br><span class="line"><span class="comment">       返回NEUTRAL，有序列表里的下个过滤器过接着处理日志；</span></span><br><span class="line"><span class="comment">       返回ACCEPT，日志会被立即处理，不再经过剩余过滤器</span></span><br><span class="line"><span class="comment">       --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.classic.filter.LevelFilter"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">level</span>&gt;</span>ERROR<span class="tag">&lt;/<span class="name">level</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">onMatch</span>&gt;</span>ACCEPT<span class="tag">&lt;/<span class="name">onMatch</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">onMismatch</span>&gt;</span>DENY<span class="tag">&lt;/<span class="name">onMismatch</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">rollingPolicy</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.core.rolling.TimeBasedRollingPolicy"</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--日志文件输出的文件名--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">FileNamePattern</span>&gt;</span>$&#123;LOG_HOME&#125;/ERROR.log.%d&#123;yyyy-MM-dd&#125;.log<span class="tag">&lt;/<span class="name">FileNamePattern</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--日志文件保留天数--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">MaxHistory</span>&gt;</span>30<span class="tag">&lt;/<span class="name">MaxHistory</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">rollingPolicy</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.classic.encoder.PatternLayoutEncoder"</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--格式化输出：%d表示日期，%thread表示线程名，%-5level：级别从左显示5个字符宽度%msg：日志消息，%n是换行符--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>%-4relative %date [%thread] %-5level %logger&#123;50&#125; - %msg%n<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--日志文件最大的大小--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">triggeringPolicy</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.core.rolling.SizeBasedTriggeringPolicy"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">MaxFileSize</span>&gt;</span>10MB<span class="tag">&lt;/<span class="name">MaxFileSize</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">triggeringPolicy</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 数据库输出 --&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">"db"</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.classic.db.DBAppender"</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">connectionSource</span></span></span><br><span class="line"><span class="tag">             <span class="attr">class</span>=<span class="string">"ch.qos.logback.core.db.DriverManagerConnectionSource"</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">driverClass</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">driverClass</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">url</span>&gt;</span>jdbc:mysql://localhost:3306/weixin_web<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">user</span>&gt;</span>root<span class="tag">&lt;/<span class="name">user</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">password</span>&gt;</span>123456<span class="tag">&lt;/<span class="name">password</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;/<span class="name">connectionSource</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- show parameters for hibernate sql 专为 Hibernate 定制 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">"org.hibernate.type.descriptor.sql.BasicBinder"</span>  <span class="attr">level</span>=<span class="string">"TRACE"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">"org.hibernate.type.descriptor.sql.BasicExtractor"</span>  <span class="attr">level</span>=<span class="string">"DEBUG"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">"org.hibernate.SQL"</span> <span class="attr">level</span>=<span class="string">"DEBUG"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">"org.hibernate.engine.QueryParameters"</span> <span class="attr">level</span>=<span class="string">"DEBUG"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">"org.hibernate.engine.query.HQLQueryPlan"</span> <span class="attr">level</span>=<span class="string">"DEBUG"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--myibatis log configure--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">"com.apache.ibatis"</span> <span class="attr">level</span>=<span class="string">"TRACE"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">"java.sql.Connection"</span> <span class="attr">level</span>=<span class="string">"DEBUG"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">"java.sql.Statement"</span> <span class="attr">level</span>=<span class="string">"DEBUG"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">"java.sql.PreparedStatement"</span> <span class="attr">level</span>=<span class="string">"DEBUG"</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 日志输出级别 --&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">root</span> <span class="attr">level</span>=<span class="string">"DEBUG"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">"STDOUT"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">"ERR_FILE"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">"INFO_FILE"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">"db"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="db日志的建表语句"><a href="#db日志的建表语句" class="headerlink" title="db日志的建表语句"></a>db日志的建表语句</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">BEGIN;</span><br><span class="line">DROP TABLE IF EXISTS logging_event_property;</span><br><span class="line">DROP TABLE IF EXISTS logging_event_exception;</span><br><span class="line">DROP TABLE IF EXISTS logging_event;</span><br><span class="line">COMMIT;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">BEGIN;</span><br><span class="line">CREATE TABLE logging_event </span><br><span class="line">  (</span><br><span class="line">    timestmp         BIGINT NOT NULL,</span><br><span class="line">    formatted_message  TEXT NOT NULL,</span><br><span class="line">    logger_name       VARCHAR(254) NOT NULL,</span><br><span class="line">    level_string      VARCHAR(254) NOT NULL,</span><br><span class="line">    thread_name       VARCHAR(254),</span><br><span class="line">    reference_flag    SMALLINT,</span><br><span class="line">    arg0              VARCHAR(254),</span><br><span class="line">    arg1              VARCHAR(254),</span><br><span class="line">    arg2              VARCHAR(254),</span><br><span class="line">    arg3              VARCHAR(254),</span><br><span class="line">    caller_filename   VARCHAR(254) NOT NULL,</span><br><span class="line">    caller_class      VARCHAR(254) NOT NULL,</span><br><span class="line">    caller_method     VARCHAR(254) NOT NULL,</span><br><span class="line">    caller_line       CHAR(4) NOT NULL,</span><br><span class="line">    event_id          BIGINT NOT NULL AUTO_INCREMENT PRIMARY KEY</span><br><span class="line">  );</span><br><span class="line">COMMIT;</span><br><span class="line"> </span><br><span class="line">BEGIN;</span><br><span class="line">CREATE TABLE logging_event_property</span><br><span class="line">  (</span><br><span class="line">    event_id          BIGINT NOT NULL,</span><br><span class="line">    mapped_key        VARCHAR(254) NOT NULL,</span><br><span class="line">    mapped_value      TEXT,</span><br><span class="line">    PRIMARY KEY(event_id, mapped_key),</span><br><span class="line">    FOREIGN KEY (event_id) REFERENCES logging_event(event_id)</span><br><span class="line">  );</span><br><span class="line">COMMIT;</span><br><span class="line"> </span><br><span class="line">BEGIN;</span><br><span class="line">CREATE TABLE logging_event_exception</span><br><span class="line">  (</span><br><span class="line">    event_id         BIGINT NOT NULL,</span><br><span class="line">    i                SMALLINT NOT NULL,</span><br><span class="line">    trace_line       VARCHAR(254) NOT NULL,</span><br><span class="line">    PRIMARY KEY(event_id, i),</span><br><span class="line">    FOREIGN KEY (event_id) REFERENCES logging_event(event_id)</span><br><span class="line">  );</span><br><span class="line">COMMIT;</span><br></pre></td></tr></table></figure>
<h2 id="分文件保存日志"><a href="#分文件保存日志" class="headerlink" title="分文件保存日志"></a>分文件保存日志</h2><blockquote>
<p><a href="https://github.com/keeleys/logback_demo" target="_blank" rel="noopener">github 参考项目</a><br>pom<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>ch.qos.logback<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>logback-classic<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.codehaus.janino<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>janino<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.7.8<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
</blockquote>
<p>java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ServiceCtrl</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Logger log = LoggerFactory.getLogger(ServiceCtrl.class);</span><br><span class="line">    <span class="keyword">private</span> Logger syslog = LoggerFactory.getLogger(<span class="string">"syslog"</span>);</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">login</span><span class="params">()</span></span>&#123;</span><br><span class="line">        String userName = <span class="string">"admin"</span>;</span><br><span class="line">        String password = <span class="string">"123"</span>;</span><br><span class="line"></span><br><span class="line">        log.info(<span class="string">"service方法 进入登陆方法"</span>);</span><br><span class="line">        log.info(<span class="string">"client方法 登陆账户&#123;&#125; ,登陆密码&#123;&#125;"</span>,userName,password);</span><br><span class="line">        log.error(<span class="string">"service方法 账户&#123;&#125;登陆失败"</span>,userName);</span><br><span class="line">        syslog.info(<span class="string">"我是syslog 我只记录在syslog.txt里面"</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>logback.xml<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;configuration debug=&quot;false&quot;&gt;</span><br><span class="line">    &lt;contextName&gt;weixin-web&lt;/contextName&gt;</span><br><span class="line">    &lt;!--定义日志文件的存储地址 勿在 LogBack 的配置中使用相对路径--&gt;</span><br><span class="line">    &lt;property name=&quot;LOG_HOME&quot; value=&quot;C:\\home\\log\\test_logback&quot; /&gt;</span><br><span class="line">    &lt;!--格式化输出：%d表示日期，%thread表示线程名，%-5level：级别从左显示5个字符宽度%msg：日志消息，%n是换行符--&gt;</span><br><span class="line">    &lt;property name=&quot;print_pattern&quot; value=&quot;%date [%thread] %-5level %logger&#123;50&#125; - %msg%n&quot; /&gt;</span><br><span class="line">    &lt;!-- 控制台输出 --&gt;</span><br><span class="line">    &lt;appender name=&quot;STDOUT&quot; class=&quot;ch.qos.logback.core.ConsoleAppender&quot;&gt;</span><br><span class="line">        &lt;encoder class=&quot;ch.qos.logback.classic.encoder.PatternLayoutEncoder&quot;&gt;</span><br><span class="line">            &lt;pattern&gt;$&#123;print_pattern&#125;&lt;/pattern&gt;</span><br><span class="line">        &lt;/encoder&gt;</span><br><span class="line">    &lt;/appender&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;appender name=&quot;INFO_FILE&quot;  class=&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;&gt;</span><br><span class="line">        &lt;!--</span><br><span class="line">          返回DENY，日志将立即被抛弃不再经过其他过滤器；</span><br><span class="line">          返回NEUTRAL，有序列表里的下个过滤器过接着处理日志；</span><br><span class="line">          返回ACCEPT，日志会被立即处理，不再经过剩余过滤器</span><br><span class="line">          --&gt;</span><br><span class="line">        &lt;filter class=&quot;ch.qos.logback.classic.filter.LevelFilter&quot;&gt;</span><br><span class="line">            &lt;level&gt;ERROR&lt;/level&gt;</span><br><span class="line">            &lt;onMatch&gt;DENY&lt;/onMatch&gt;</span><br><span class="line">            &lt;onMismatch&gt;ACCEPT&lt;/onMismatch&gt;</span><br><span class="line">        &lt;/filter&gt;</span><br><span class="line">        &lt;!-- 按照每天生成日志文件 --&gt;</span><br><span class="line">        &lt;rollingPolicy class=&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;&gt;</span><br><span class="line">            &lt;!--日志文件输出的文件名--&gt;</span><br><span class="line">            &lt;FileNamePattern&gt;$&#123;LOG_HOME&#125;/info.log.%d&#123;yyyy-MM-dd&#125;.log&lt;/FileNamePattern&gt;</span><br><span class="line">            &lt;!--日志文件保留天数--&gt;</span><br><span class="line">            &lt;MaxHistory&gt;30&lt;/MaxHistory&gt;</span><br><span class="line">        &lt;/rollingPolicy&gt;</span><br><span class="line">        &lt;encoder class=&quot;ch.qos.logback.classic.encoder.PatternLayoutEncoder&quot;&gt;</span><br><span class="line">            &lt;pattern&gt;$&#123;print_pattern&#125;&lt;/pattern&gt;</span><br><span class="line">        &lt;/encoder&gt;</span><br><span class="line">        &lt;!--日志文件最大的大小--&gt;</span><br><span class="line">        &lt;triggeringPolicy class=&quot;ch.qos.logback.core.rolling.SizeBasedTriggeringPolicy&quot;&gt;</span><br><span class="line">            &lt;MaxFileSize&gt;100MB&lt;/MaxFileSize&gt;</span><br><span class="line">        &lt;/triggeringPolicy&gt;</span><br><span class="line">    &lt;/appender&gt;</span><br><span class="line">    &lt;appender name=&quot;ERR_FILE&quot;  class=&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;filter class=&quot;ch.qos.logback.classic.filter.LevelFilter&quot;&gt;</span><br><span class="line">            &lt;level&gt;ERROR&lt;/level&gt;</span><br><span class="line">            &lt;onMatch&gt;ACCEPT&lt;/onMatch&gt;</span><br><span class="line">            &lt;onMismatch&gt;DENY&lt;/onMismatch&gt;</span><br><span class="line">        &lt;/filter&gt;</span><br><span class="line">        &lt;rollingPolicy class=&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;&gt;</span><br><span class="line">            &lt;!--日志文件输出的文件名--&gt;</span><br><span class="line">            &lt;FileNamePattern&gt;$&#123;LOG_HOME&#125;/error.log.%d&#123;yyyy-MM-dd&#125;.log&lt;/FileNamePattern&gt;</span><br><span class="line">            &lt;!--日志文件保留天数--&gt;</span><br><span class="line">            &lt;MaxHistory&gt;30&lt;/MaxHistory&gt;</span><br><span class="line">        &lt;/rollingPolicy&gt;</span><br><span class="line">        &lt;encoder class=&quot;ch.qos.logback.classic.encoder.PatternLayoutEncoder&quot;&gt;</span><br><span class="line">            &lt;pattern&gt;$&#123;print_pattern&#125;&lt;/pattern&gt;</span><br><span class="line">        &lt;/encoder&gt;</span><br><span class="line">        &lt;!--日志文件最大的大小--&gt;</span><br><span class="line">        &lt;triggeringPolicy class=&quot;ch.qos.logback.core.rolling.SizeBasedTriggeringPolicy&quot;&gt;</span><br><span class="line">            &lt;MaxFileSize&gt;10MB&lt;/MaxFileSize&gt;</span><br><span class="line">        &lt;/triggeringPolicy&gt;</span><br><span class="line">    &lt;/appender&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;appender name=&quot;SERVICE_FILE&quot;  class=&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;&gt;</span><br><span class="line">        &lt;filter class=&quot;ch.qos.logback.core.filter.EvaluatorFilter&quot;&gt;</span><br><span class="line">            &lt;evaluator&gt;</span><br><span class="line">                &lt;expression&gt;return message.contains(&quot;service方法&quot;);&lt;/expression&gt;</span><br><span class="line">            &lt;/evaluator&gt;</span><br><span class="line">            &lt;OnMatch&gt;ACCEPT&lt;/OnMatch&gt;</span><br><span class="line">            &lt;OnMismatch&gt;DENY&lt;/OnMismatch&gt;</span><br><span class="line">        &lt;/filter&gt;</span><br><span class="line">        &lt;rollingPolicy class=&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;&gt;</span><br><span class="line">            &lt;FileNamePattern&gt;$&#123;LOG_HOME&#125;/service.log.%d&#123;yyyy-MM-dd&#125;.log&lt;/FileNamePattern&gt;</span><br><span class="line">            &lt;MaxHistory&gt;30&lt;/MaxHistory&gt;</span><br><span class="line">        &lt;/rollingPolicy&gt;</span><br><span class="line">        &lt;encoder class=&quot;ch.qos.logback.classic.encoder.PatternLayoutEncoder&quot;&gt;</span><br><span class="line">            &lt;pattern&gt;$&#123;print_pattern&#125;&lt;/pattern&gt;</span><br><span class="line">        &lt;/encoder&gt;</span><br><span class="line">    &lt;/appender&gt;</span><br><span class="line"></span><br><span class="line">    &lt;appender name=&quot;syslogFile&quot; class=&quot;ch.qos.logback.core.FileAppender&quot;&gt;</span><br><span class="line">        &lt;file&gt;$&#123;LOG_HOME&#125;/syslogFile.log&lt;/file&gt;</span><br><span class="line">        &lt;append&gt;true&lt;/append&gt;</span><br><span class="line">        &lt;encoder&gt;</span><br><span class="line">            &lt;pattern&gt;$&#123;print_pattern&#125;&lt;/pattern&gt;</span><br><span class="line">        &lt;/encoder&gt;</span><br><span class="line">    &lt;/appender&gt;</span><br><span class="line">    &lt;!-- show parameters for hibernate sql 专为 Hibernate 定制 --&gt;</span><br><span class="line">    &lt;logger name=&quot;org.hibernate.type.descriptor.sql.BasicBinder&quot;  level=&quot;TRACE&quot; /&gt;</span><br><span class="line">    &lt;logger name=&quot;org.hibernate.type.descriptor.sql.BasicExtractor&quot;  level=&quot;DEBUG&quot; /&gt;</span><br><span class="line">    &lt;logger name=&quot;org.hibernate.SQL&quot; level=&quot;DEBUG&quot; /&gt;</span><br><span class="line">    &lt;logger name=&quot;org.hibernate.engine.QueryParameters&quot; level=&quot;DEBUG&quot; /&gt;</span><br><span class="line">    &lt;logger name=&quot;org.hibernate.engine.query.HQLQueryPlan&quot; level=&quot;DEBUG&quot; /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!--myibatis log configure--&gt;</span><br><span class="line">    &lt;logger name=&quot;com.apache.ibatis&quot; level=&quot;TRACE&quot;/&gt;</span><br><span class="line">    &lt;logger name=&quot;java.sql.Connection&quot; level=&quot;DEBUG&quot;/&gt;</span><br><span class="line">    &lt;logger name=&quot;java.sql.Statement&quot; level=&quot;DEBUG&quot;/&gt;</span><br><span class="line">    &lt;logger name=&quot;java.sql.PreparedStatement&quot; level=&quot;DEBUG&quot;/&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;logger name=&quot;syslog&quot; level=&quot;INFO&quot; additivity=&quot;false&quot;&gt;</span><br><span class="line">        &lt;appender-ref ref=&quot;syslogFile&quot; /&gt;</span><br><span class="line">    &lt;/logger&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 日志输出级别 --&gt;</span><br><span class="line">    &lt;root level=&quot;DEBUG&quot;&gt;</span><br><span class="line">        &lt;appender-ref ref=&quot;STDOUT&quot; /&gt;</span><br><span class="line">        &lt;appender-ref ref=&quot;SERVICE_FILE&quot; /&gt;</span><br><span class="line">        &lt;appender-ref ref=&quot;ERR_FILE&quot; /&gt;</span><br><span class="line">        &lt;appender-ref ref=&quot;INFO_FILE&quot; /&gt;</span><br><span class="line">    &lt;/root&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure></p>
<h2 id="log4j-转logback"><a href="#log4j-转logback" class="headerlink" title="log4j 转logback"></a>log4j 转logback</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- LOGGING begin --&gt;</span><br><span class="line">  &lt;dependency&gt;</span><br><span class="line">      &lt;groupId&gt;org.slf4j&lt;/groupId&gt;</span><br><span class="line">      &lt;artifactId&gt;slf4j-api&lt;/artifactId&gt;</span><br><span class="line">      &lt;version&gt;$&#123;slf4j.version&#125;&lt;/version&gt;</span><br><span class="line">  &lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">  &lt;dependency&gt;</span><br><span class="line">      &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;</span><br><span class="line">      &lt;artifactId&gt;logback-classic&lt;/artifactId&gt;</span><br><span class="line">      &lt;version&gt;1.0.13&lt;/version&gt;</span><br><span class="line">      &lt;scope&gt;runtime&lt;/scope&gt;</span><br><span class="line">  &lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-- 代码直接调用log4j会被桥接到slf4j --&gt;</span><br><span class="line">  &lt;dependency&gt;</span><br><span class="line">      &lt;groupId&gt;org.slf4j&lt;/groupId&gt;</span><br><span class="line">      &lt;artifactId&gt;log4j-over-slf4j&lt;/artifactId&gt;</span><br><span class="line">      &lt;version&gt;$&#123;slf4j.version&#125;&lt;/version&gt;</span><br><span class="line">      &lt;scope&gt;runtime&lt;/scope&gt;</span><br><span class="line">  &lt;/dependency&gt;</span><br><span class="line">  &lt;!-- 代码直接调用common-logging会被桥接到slf4j --&gt;</span><br><span class="line">  &lt;dependency&gt;</span><br><span class="line">      &lt;groupId&gt;org.slf4j&lt;/groupId&gt;</span><br><span class="line">      &lt;artifactId&gt;jcl-over-slf4j&lt;/artifactId&gt;</span><br><span class="line">      &lt;version&gt;$&#123;slf4j.version&#125;&lt;/version&gt;</span><br><span class="line">      &lt;scope&gt;runtime&lt;/scope&gt;</span><br><span class="line">  &lt;/dependency&gt;</span><br><span class="line">  &lt;!-- 代码直接调用java.util.logging会被桥接到slf4j --&gt;</span><br><span class="line">  &lt;dependency&gt;</span><br><span class="line">      &lt;groupId&gt;org.slf4j&lt;/groupId&gt;</span><br><span class="line">      &lt;artifactId&gt;jul-to-slf4j&lt;/artifactId&gt;</span><br><span class="line">      &lt;version&gt;$&#123;slf4j.version&#125;&lt;/version&gt;</span><br><span class="line">      &lt;scope&gt;runtime&lt;/scope&gt;</span><br><span class="line">  &lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">  &lt;dependency&gt;</span><br><span class="line">      &lt;groupId&gt;org.bgee.log4jdbc-log4j2&lt;/groupId&gt;</span><br><span class="line">      &lt;artifactId&gt;log4jdbc-log4j2-jdbc4&lt;/artifactId&gt;</span><br><span class="line">      &lt;version&gt;1.15&lt;/version&gt;</span><br><span class="line">      &lt;scope&gt;runtime&lt;/scope&gt;</span><br><span class="line">  &lt;/dependency&gt;</span><br><span class="line">  &lt;!-- LOGGING end --&gt;</span><br></pre></td></tr></table></figure>
      
    </div>

    
      
      

  <div class="post-copyright">
    <p class="copyright-item">
      <span>原文作者: </span>
      <a href="http://www.sitec.cc">keeleys</a>
    </p>
    <p class="copyright-item">
      <span>原文链接: </span>
      <a href="http://www.sitec.cc/2015/10/30/logback/">http://www.sitec.cc/2015/10/30/logback/</a>
    </p>
    <p class="copyright-item">
      <span>许可协议: </span>
      
      <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank">知识共享署名-非商业性使用 4.0 国际许可协议</a>
    </p>
  </div>



      
      
    

    
      <footer class="post-footer">
        
          <div class="post-tags">
            
              <a href="/tags/java/">java</a>
            
          </div>
        
        
        
  <nav class="post-nav">
    
      <a class="prev" href="/2015/11/10/centermaven/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">发布构建到中央仓库</span>
        <span class="prev-text nav-mobile">上一篇</span>
      </a>
    
    
      <a class="next" href="/2015/10/21/common-kit/">
        <span class="next-text nav-default">收集整理的一些java工具类</span>
        <span class="prev-text nav-mobile">下一篇</span>
        <i class="iconfont icon-right"></i>
      </a>
    
  </nav>

      </footer>
    

  </article>


          </div>
          
  <div class="comments" id="comments">
    
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    
  </div>


        </div>
      </main>

      <footer id="footer" class="footer">

  <div class="social-links">
    
      
        
          <a href="mailto:your@email.com" class="iconfont icon-email" title="email"></a>
        
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
    
    
      
      <a href="/atom.xml" class="iconfont icon-rss" title="rss"></a>
    
  </div>


<div class="copyright">
  <span class="copyright-year">
    
    &copy; 
     
      2015 - 
    
    2018

    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">keeleys</span>
  </span>
</div>

      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>

    
  
  <script type="text/javascript">
    var disqus_config = function () {
        this.page.url = 'http://www.sitec.cc/2015/10/30/logback/';
        this.page.identifier = '2015/10/30/logback/';
        this.page.title = '使用logback记录日志';
    };
    (function() {
    var d = document, s = d.createElement('script');

    s.src = '//sitecc.disqus.com/embed.js';

    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();  
  </script>

  

  



    




  
    <script type="text/javascript" src="/lib/jquery/jquery-3.1.1.min.js"></script>
  

  
    <script type="text/javascript" src="/lib/slideout/slideout.js"></script>
  

  


    <script type="text/javascript" src="/js/src/even.js?v=2.6.0"></script>
<script type="text/javascript" src="/js/src/bootstrap.js?v=2.6.0"></script>

  </body>
</html>
